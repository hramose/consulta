{"version":3,"sources":["assistant.invoices.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"assistant.invoices.min.js","sourcesContent":["$(function () {\r\n\r\n\r\n     $(\".dropdown-toggle\").dropdown();\r\n     var infoBox = $(\"#infoBox\");\r\n     var modalForm = $('#modalInvoice');\r\n\r\n    function money(n, currency) {\r\n\r\n        return n.toLocaleString();//toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\")\r\n    }\r\n\r\n    $('.btn-facturar').on('click',function (e) {\r\n        e.preventDefault();\r\n      \r\n         var invoice_id = $(this).attr('data-invoice');\r\n         var medic_id = $(this).attr('data-medic');\r\n        $.ajax({\r\n            type: 'PUT',\r\n            url: '/assistant/invoices/'+invoice_id,\r\n            data: {client_name: $('input[name=\"client_name\"]').val()},\r\n            success: function (resp) {\r\n               \r\n              infoBox.addClass('alert-success').html('Factura procesada!!!').show();\r\n              setTimeout(function()\r\n              { \r\n                infoBox.removeClass('alert-success').hide();\r\n              },3000);\r\n              \r\n              if(medic_id)\r\n                 window.location.href = \"/assistant/medics/\"+ medic_id +\"/invoices\";\r\n             else\r\n                window.location.href = \"/assistant/invoices\";\r\n              \r\n                \r\n            },\r\n            error: function () {\r\n              console.log('error get details');\r\n\r\n            }\r\n        });\r\n     \r\n\r\n    });\r\n\r\n    modalForm.on('hidden.bs.modal', function (e) {\r\n      var modal = $(this);\r\n      var table_details = modal.find('#table-details')\r\n      table_details.find('tbody').html('');\r\n      modal.find('#modal-label-medic').text('')\r\n    });\r\n     modalForm.on('shown.bs.modal', function (event) {\r\n     \r\n      var button = $(event.relatedTarget)\r\n      var modal = $(this);\r\n      var invoice_id = button.attr('data-id')\r\n      var medic_id = button.attr('data-medic')  \r\n      var table_details = modal.find('#table-details')\r\n      var detailsHtml = '';\r\n      modal.find('.btn-facturar').attr('data-invoice', invoice_id);\r\n      modal.find('.btn-facturar').attr('data-medic', medic_id);\r\n\r\n\r\n     \r\n       $.ajax({\r\n            type: 'GET',\r\n            url: '/assistant/invoices/'+invoice_id+'/details',\r\n            data: {},\r\n            success: function (resp) {\r\n               modal.find('#modal-label-medic').text('')\r\n               table_details.find('tbody').html('');\r\n              \r\n\r\n               modal.find('#modal-label-medic').text(resp.medic.name);\r\n\r\n               $.each(resp.lines, function( index, item ) {\r\n                   \r\n                   detailsHtml +='<tr><td>'+ item.quantity +'</td><td>'+ item.service +'</td><td>'+ money(item.amount) +'</td><td>'+ money(item.amount * item.quantity)  +'</td><td>'+ money(item.total_line) +'</td></tr>'\r\n\r\n                });\r\n\r\n               table_details.find('tbody').html(detailsHtml);\r\n               \r\n               $(\"#modalInvoiceLabel\").html('Factura #'+ invoice_id + '  <span class=\"label label-warning pull-right\">'+resp.created_at+'</span>');\r\n               $(\"#modal-label-total\").html('Total: â‚¡<span>'+ money(resp.total)+'</span>');\r\n                \r\n            },\r\n            error: function () {\r\n              console.log('error get details');\r\n\r\n            }\r\n        });\r\n     \r\n  \r\n     \r\n      \r\n   \r\n    });\r\n\r\n});\r\n"]}