$(function(){function t(t,a){return t.toLocaleString()}$(".dropdown-toggle").dropdown();var a=$("#infoBox"),n=$("#modalInvoice");$(".date").datetimepicker({format:"YYYY-MM-DD",locale:"es"}),$(".btn-facturar").on("click",function(t){t.preventDefault();var n=$(this).attr("data-invoice");$(this).attr("data-medic");$.ajax({type:"PUT",url:"/assistant/invoices/"+n,data:{client_name:$('input[name="client_name"]').val()},success:function(t){a.addClass("alert-success").html("Factura procesada!!!").show(),setTimeout(function(){a.removeClass("alert-success").hide()},3e3),$("#rd_ticket").is(":checked")?window.location.href="/assistant/invoices/"+n+"/ticket":window.location.href="/assistant/invoices/"+n+"/print"},error:function(){}})}),$(".btn-print").on("click",function(t){t.preventDefault();var a=$(this).attr("data-invoice");$(this).attr("data-medic");$("#rd_ticket").is(":checked")?window.location.href="/assistant/invoices/"+a+"/ticket":window.location.href="/assistant/invoices/"+a+"/print"}),n.on("hidden.bs.modal",function(t){var a=$(this),n=a.find("#table-details");n.find("tbody").html(""),a.find("#modal-label-medic").text("")}),n.on("shown.bs.modal",function(a){var n=$(a.relatedTarget),i=$(this),e=n.attr("data-id"),d=n.attr("data-medic"),o=i.find("#table-details"),l="";i.find(".btn-facturar").attr("data-invoice",e),i.find(".btn-facturar").attr("data-medic",d),i.find(".btn-print").attr("data-invoice",e),i.find(".btn-print").attr("data-medic",d),$.ajax({type:"GET",url:"/assistant/invoices/"+e+"/details",data:{},success:function(a){i.find("#modal-label-medic").text(""),o.find("tbody").html(""),i.find("#modal-label-medic").text(a.medic.name),i.find("#modal-label-patient").text(a.appointment.patient.fullname),i.find("#modal-label-patient").text(a.appointment.patient.fullname),$('input[name="client_name"]').val(a.appointment.patient.fullname),$.each(a.lines,function(a,n){l+="<tr><td>"+n.quantity+"</td><td>"+n.service+"</td><td>"+t(n.amount)+"</td><td>"+t(n.total_line)+"</td></tr>"}),o.find("tbody").html(l),$("#modalInvoiceLabel").html("Factura #"+e+'  <span class="label label-warning pull-right">'+a.created_at+"</span>"),$("#modal-label-total").html("Total: â‚¡<span>"+t(a.total)+"</span>")},error:function(){}})})});